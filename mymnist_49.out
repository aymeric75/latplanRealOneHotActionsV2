Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '49'}
gtgtgt
gtgtgt
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
all_combis_augmented
[array([0, 1, 1]), array([0, 1, 2]), array([0, 1, 3]), array([0, 1, 4]), array([0, 1, 5]), array([0, 1, 6]), array([0, 1, 7]), array([0, 1, 8]), array([0, 3, 1]), array([0, 3, 2]), array([0, 3, 3]), array([0, 3, 4]), array([0, 3, 5]), array([0, 3, 6]), array([0, 3, 7]), array([0, 3, 8]), array([1, 1, 1]), array([1, 1, 2]), array([1, 1, 3]), array([1, 1, 4]), array([1, 1, 5]), array([1, 1, 6]), array([1, 1, 7]), array([1, 1, 8]), array([1, 2, 1]), array([1, 2, 2]), array([1, 2, 3]), array([1, 2, 4]), array([1, 2, 5]), array([1, 2, 6]), array([1, 2, 7]), array([1, 2, 8]), array([1, 3, 1]), array([1, 3, 2]), array([1, 3, 3]), array([1, 3, 4]), array([1, 3, 5]), array([1, 3, 6]), array([1, 3, 7]), array([1, 3, 8]), array([2, 1, 1]), array([2, 1, 2]), array([2, 1, 3]), array([2, 1, 4]), array([2, 1, 5]), array([2, 1, 6]), array([2, 1, 7]), array([2, 1, 8]), array([2, 2, 1]), array([2, 2, 2]), array([2, 2, 3]), array([2, 2, 4]), array([2, 2, 5]), array([2, 2, 6]), array([2, 2, 7]), array([2, 2, 8]), array([3, 0, 1]), array([3, 0, 2]), array([3, 0, 3]), array([3, 0, 4]), array([3, 0, 5]), array([3, 0, 6]), array([3, 0, 7]), array([3, 0, 8]), array([3, 1, 1]), array([3, 1, 2]), array([3, 1, 3]), array([3, 1, 4]), array([3, 1, 5]), array([3, 1, 6]), array([3, 1, 7]), array([3, 1, 8]), array([3, 3, 1]), array([3, 3, 2]), array([3, 3, 3]), array([3, 3, 4]), array([3, 3, 5]), array([3, 3, 6]), array([3, 3, 7]), array([3, 3, 8]), array([4, 0, 1]), array([4, 0, 2]), array([4, 0, 3]), array([4, 0, 4]), array([4, 0, 5]), array([4, 0, 6]), array([4, 0, 7]), array([4, 0, 8]), array([4, 1, 1]), array([4, 1, 2]), array([4, 1, 3]), array([4, 1, 4]), array([4, 1, 5]), array([4, 1, 6]), array([4, 1, 7]), array([4, 1, 8]), array([4, 2, 1]), array([4, 2, 2]), array([4, 2, 3]), array([4, 2, 4]), array([4, 2, 5]), array([4, 2, 6]), array([4, 2, 7]), array([4, 2, 8]), array([4, 3, 1]), array([4, 3, 2]), array([4, 3, 3]), array([4, 3, 4]), array([4, 3, 5]), array([4, 3, 6]), array([4, 3, 7]), array([4, 3, 8]), array([5, 0, 1]), array([5, 0, 2]), array([5, 0, 3]), array([5, 0, 4]), array([5, 0, 5]), array([5, 0, 6]), array([5, 0, 7]), array([5, 0, 8]), array([5, 1, 1]), array([5, 1, 2]), array([5, 1, 3]), array([5, 1, 4]), array([5, 1, 5]), array([5, 1, 6]), array([5, 1, 7]), array([5, 1, 8]), array([5, 2, 1]), array([5, 2, 2]), array([5, 2, 3]), array([5, 2, 4]), array([5, 2, 5]), array([5, 2, 6]), array([5, 2, 7]), array([5, 2, 8]), array([6, 0, 1]), array([6, 0, 2]), array([6, 0, 3]), array([6, 0, 4]), array([6, 0, 5]), array([6, 0, 6]), array([6, 0, 7]), array([6, 0, 8]), array([6, 3, 1]), array([6, 3, 2]), array([6, 3, 3]), array([6, 3, 4]), array([6, 3, 5]), array([6, 3, 6]), array([6, 3, 7]), array([6, 3, 8]), array([7, 0, 1]), array([7, 0, 2]), array([7, 0, 3]), array([7, 0, 4]), array([7, 0, 5]), array([7, 0, 6]), array([7, 0, 7]), array([7, 0, 8]), array([7, 2, 1]), array([7, 2, 2]), array([7, 2, 3]), array([7, 2, 4]), array([7, 2, 5]), array([7, 2, 6]), array([7, 2, 7]), array([7, 2, 8]), array([7, 3, 1]), array([7, 3, 2]), array([7, 3, 3]), array([7, 3, 4]), array([7, 3, 5]), array([7, 3, 6]), array([7, 3, 7]), array([7, 3, 8]), array([8, 0, 1]), array([8, 0, 2]), array([8, 0, 3]), array([8, 0, 4]), array([8, 0, 5]), array([8, 0, 6]), array([8, 0, 7]), array([8, 0, 8]), array([8, 2, 1]), array([8, 2, 2]), array([8, 2, 3]), array([8, 2, 4]), array([8, 2, 5]), array([8, 2, 6]), array([8, 2, 7]), array([8, 2, 8])]
all_combis_augmentedlol
[2 1 2]
192
ppppppppppppp
<module 'latplan.puzzles.puzzle_mnist' from '/workspace/latplanRealOneHotActionsV2/latplan/puzzles/puzzle_mnist.py'>
custom true
pres_configs 000
12000
[7 5 8 4 0 2 1 3 6]
[7 0 8 4 5 2 1 3 6]
pres_configspres_configspres_configspres_configspres_configspres_configspres_configspres_configspres_configspres_configs
right_pres_configs
tensor([7, 5, 8, 4, 0, 2, 1, 3, 6])
torch.Size([12000, 9])
right_sucs_configs
tensor([7, 0, 8, 4, 5, 2, 1, 3, 6])
zero_positions_pres
tensor(6)

zero_positions_sucs
tensor(3)

pres_minus_three
tensor(3)
pres_plus_one
tensor(7)
pres_minus_one
tensor(5)
top_moves[600]
tensor(True)
right_moves[600]
tensor(False)
left_moves[600]
tensor(False)
down_moves[600]
tensor(False)
ggggg
tensor(0, dtype=torch.int32)
theallactions0000000000
tensor(0, dtype=torch.int32)
zero_positions_pres
tensor(4)
iiiii
tensor([7, 0, 8, 4, 5, 2, 1, 3, 6])
tensor(5)
neighsssss
kkk
torch.Size([12000])
torch.Size([12000])
theallactions
tensor([0, 2, 0], dtype=torch.int32)
pos_and_move size 1
torch.Size([12000, 2])
tensor([6, 0])
pos_and_move size 2
torch.Size([12000, 2])
ooo
192
24
actions_one_hot
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]])
torch.Size([12000, 24])
gtgtgt
gtgtgt
actionstrn
putain
12
the f*** action
(array([20]),)
[0 3 1]
loaded. picsize: [48, 48]
(12000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
actions_transitionsactions_transitions
<class 'numpy.ndarray'>
(12000, 24)
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0]


<class 'numpy.ndarray'>
(12000, 2, 48, 48, 1)
samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/49
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x7f55948d4340>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x7f55948d4340>
<keras.layers.normalization.BatchNormalization object at 0x7f55948e4dc0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x7f55948e4dc0>
<keras.layers.core.Dropout object at 0x7f55948e4430>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x7f55948e4430>
<keras.layers.convolutional.Conv2D object at 0x7f55948e4490>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x7f55948e4490>
<keras.layers.normalization.BatchNormalization object at 0x7f55948e4310>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x7f55948e4310>
<keras.layers.core.Dropout object at 0x7f55948e4190>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x7f55948e4190>
latent space shape is (48, 48, 32) : 49 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x7f5594883340>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x7f5594883340>
<keras.layers.convolutional.Conv2DTranspose object at 0x7f5594883370>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x7f5594883370>
<keras.layers.normalization.BatchNormalization object at 0x7f5594883550>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x7f5594883550>
<keras.layers.core.Dropout object at 0x7f5594883a90>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x7f5594883a90>
<keras.layers.convolutional.Conv2DTranspose object at 0x7f5594883490>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x7f5594883490>
eff 0
uhuhihh
(?, 2, 48, 48, 1)
action_inputaction_input
(?, 24)
this apply3
Network built
Building auxiliary networks
this apply3
Auxiliary network built
